---
title: "Master Equations in Healthcare: Patient Flow Modeling"
format: revealjs
---

# What Are Master Equations?

- A **Master Equation** tracks the time evolution of **probabilities** of a system's states.
- It governs systems where **discrete states** change stochastically over time.
- In healthcare: patients transitioning between care units (ER → ICU → Discharge)

---

# Why Use Master Equations in Healthcare?

✅ Probabilistic modeling of uncertainty  
✅ Handles **small populations** better than deterministic models  
✅ Supports **realistic transitions** (e.g., not everyone gets discharged directly)  
✅ Basis for **simulation**, **decision-making**, **queueing**

---

# Example: Patient Flow Model

States:

- **0**: Emergency Room (ER)  
- **1**: Ward  
- **2**: ICU  
- **3**: Discharged (absorbing state)

---

# Transition Diagram

```{mermaid}
graph LR
    ER((0: ER)) -->|r01| Ward((1: Ward))
    ER -->|r02| ICU((2: ICU))
    Ward -->|r13| Discharged((3: Discharged))
    ICU -->|r23| Discharged
```

# Master Equations

Let $\( P_i(t) \)$ be the probability of being in state $\( i \)$ at time $\( t \)$:

$$\[
\begin{aligned}
\frac{dP_0}{dt} &= - (r_{01} + r_{02}) P_0 \\
\frac{dP_1}{dt} &= r_{01} P_0 - r_{13} P_1 \\
\frac{dP_2}{dt} &= r_{02} P_0 - r_{23} P_2 \\
\frac{dP_3}{dt} &= r_{13} P_1 + r_{23} P_2
\end{aligned}
\]$$

# Python Code: Define the Model

```{python}
import numpy as np
from scipy.integrate import solve_ivp
import matplotlib.pyplot as plt

# Transition rates
r01, r02 = 0.4, 0.2
r13, r23 = 0.1, 0.05

def patient_flow(t, P):
    P0, P1, P2, P3 = P
    dP0 = -(r01 + r02) * P0
    dP1 = r01 * P0 - r13 * P1
    dP2 = r02 * P0 - r23 * P2
    dP3 = r13 * P1 + r23 * P2
    return [dP0, dP1, dP2, dP3]
```


```{python}
# Initial conditions: all patients start in ER
P_init = [1.0, 0.0, 0.0, 0.0]

# Time domain
t_span = (0, 100)
t_eval = np.linspace(*t_span, 500)

# Solve using ODE solver
solution = solve_ivp(patient_flow, t_span, P_init, t_eval=t_eval)
```
